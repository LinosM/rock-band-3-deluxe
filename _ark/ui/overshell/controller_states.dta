(kState_RB3EControllerMenu
   (view options_extras)
   (enter
      {options_extras.lst set circular 0}
      {options_extras.lst set_selected 0}
      {options_extras.lst set_data
         (
            {if_else 
               {&&
                  {== $dx_joypad_type_guitar kControllerGuitar}
                  {== $dx_joypad_type_keys kControllerKeys}
                  {== $dx_joypad_type_vocals kControllerVocals}
               }
               os_instswap os_instreset}
            os_mappingswap
         )})
   (SELECT_MSG
      {switch {$component selected_sym}
         (os_instswap
            {switch {{$this get_user} get_controller_type}
               (kControllerGuitar
                  {$this show_state kState_RB3EInstSwapGuitar})
               (kControllerKeys
                  {$this show_state kState_RB3EInstSwapKeys})
               (kControllerVocals
                  {$this show_state kState_RB3EInstSwapVocals})})
         (os_instreset
            DX_RESET_INST_TYPES
            {overshell update_all})
         (os_mappingswap
            {$this show_state kState_RB3EInstSwap})})
   (on_cancel
      {$this show_state kState_RB3ESettings}))
	  
(kState_RB3EInstSwapGuitar
   (view options)
   (enter
      DX_OS_OPEN_MSG
      DX_INST_SWAP_DESC_GUITAR
      {options.lst set circular 0}
      {options.lst set_selected 0}
      {options.lst set_data 
         (
            drums
            vocals
         )})
   (SELECT_MSG
      {switch {$component selected_sym}
         (drums
            {set $dx_joypad_type_guitar kControllerDrum})
         (vocals
            {set $dx_joypad_type_guitar kControllerVocals})}
      DX_OS_CLOSE_MSG
      {overshell update_all})
   (on_cancel
      DX_OS_CLOSE_MSG
      {$this show_state kState_RB3EControllerMenu}))
	  
(kState_RB3EInstSwapKeys
   (view options)
   (enter
      DX_OS_OPEN_MSG
      DX_INST_SWAP_DESC_KEYS
      {options.lst set circular 0}
      {options.lst set_selected 0}
      {options.lst set_data 
         (
            keys
            drums
            vocals
         )})
   (SELECT_MSG
      {switch {$component selected_sym}
         (drums
            {set $dx_joypad_type_keys kControllerDrum})
         (vocals
            {set $dx_joypad_type_keys kControllerVocals})
      DX_OS_CLOSE_MSG
      {overshell update_all}})
   (on_cancel
      DX_OS_CLOSE_MSG
      {$this show_state kState_RB3EControllerMenu}))
	  
(kState_RB3EInstSwapVocals
   (view options)
   (enter
      DX_OS_OPEN_MSG
      DX_INST_SWAP_DESC_VOCALS
      {options.lst set circular 0}
      {options.lst set_selected 0}
      {options.lst set_data 
         (
            guitar
            keys
            drums
         )})
   (SELECT_MSG
      {switch {$component selected_sym}
         (guitar
            {set $dx_joypad_type_vocals kControllerGuitar})
         (drums
            {set $dx_joypad_type_vocals kControllerDrum})
         (keys
            {set $dx_joypad_type_vocals kControllerKeys})}
      DX_OS_CLOSE_MSG
      {overshell update_all})
   (on_cancel
      DX_OS_CLOSE_MSG
      {$this show_state kState_RB3EControllerMenu}))